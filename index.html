<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>SUCCSS: the CSS regression testing tool</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">

  <link rel="icon" href="/favicon.ico" type="image/x-icon" />
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />

  <link rel="stylesheet" href="css/styles.css">
  <script type="text/javascript" src="js/color-squares.js"></script>
  <link rel="stylesheet" href="css/twitter.css">

  <script type="text/javascript" src="js/prism.js"></script>
  <link rel="stylesheet" href="css/prism.css">

  <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:700' rel='stylesheet' type='text/css'>

</head>

<body>

  <a id="fork-on-github" href="https://github.com/B2F/Succss"><img style="position: fixed; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png"></a>

  <header>
    <a href="/home" title="home"><span id="logo">SUCCSS</span></a>
    <img id="logo-image" src="img/arc-logo.png"/><img width="161" id="click-here" src="img/click-here.png"/>
    <div id="header-text">
      <span id="static-line">Succss! Easy to install, easy to use CSS regression testing tool.<br/></span>
      <span id="dynamic-line">Turn your <strong>C</strong>ascading <strong>S</strong>tlye<strong>S</strong>heets into <strong>success</strong>ful design integrations.</span>
    </div>
    <a href="" id="twitter-button" title="Found the hidden GET params meaning yet ? Tweak it ! Share a customised version of this page."><i></i><span class="label">Tweet</span></a>
  </header>

  <div id="core">

    <article id="home">

      <span class="headline">Grab it:</span>
      <pre>npm install -g succss</pre>
      <div class="tips">Succss rely on <a href="http://phantomjs.org/" target="_blank">PhantomJS</a> and <a href="http://casperjs.org/" target="_blank">CasperJS</a> dependencies, automatically resolved by <a href="https://www.npmjs.com/" target="_blank">npm</a>. Follow <a href="/installation">this guide</a> if you have trouble with npm.</div>

      <span class="headline">Describe your website CSS:</span>
      <pre class="code" style="height:500px;"><code class="language-javascript">//data.js
Succss.pages = {
  'any webpage': {
    url:'succss.ifzenelse.net',
    directory:'screenshots',
    captures: {
      // Key:name Value:CSS selector.
      'header':'header',
      'square1':'#red.color-square',
      'square2':'#green.color-square',
      'square3':'#blue.color-square'
    },
  },
  'another one': { 
    ... 
  }
};

Succss.viewports: {
  'classic wide': {
    width: 1366,
    height: 768
  },
  'mobile': {
    width: 320,
    height: 480
  },
  ...
}</code></pre>

      <div class="tips">Succss can be used in many ways, for many use cases.
        Later, you can also read <a href="/configuration">advanced Configuration</a>.</div>

      <span class="headline">Take base screenshots:</span>
      <pre><code>succss add data.js</code></pre>
      <div class="tips">For advanced usage, the succss command has several options such as pages, captures and viewports <a href="/commandline#filters">filters</a>.</div>

      <span class="headline">Compare base screenshots to updates:</span>
      <pre><code>succss check data.js</code></pre>
      <div class="tips">Succss is bundled with imagediff (default) and ResembleJS for comparisons. Captures validations can be fully <a href="customize">customized</a>.</div>

      <span class="headline" id="differences">See differences or success:</span>
      <pre><img src="img/screenshots/imagediff.jpeg"/></pre>
      <div class="tips">This image extracted from selftests displays how differences are highlighted by <a href="https://github.com/HumbleSoftware/js-imagediff" target="_blank">Imagediff</a>. Take a look at <a href="/fork">Succss source code</a> if you know javascript.</div>

    </article>

    <article id="installation">

      <h1>Installation Troubleshooting</h1>

      <h2>Requirements</h2>
      <span class="headline">There is only two simple requirements to get Succss and to run it.</span>
      <ul>
        <li>1. how to get Succss ? <strong><a href="https://www.npmjs.com/">npm</a></strong> </li>
        <li>2. how to run it ? <strong><a href="https://www.python.org/">python</a></strong></li>
      </ul>
      <div class="tips">You could checkout the Succss git repository, symlink it's binary to your system and have CasperJS installed separately, but well... who would do that ?</div>

      <h2>npm</h2>
      <span class="headline">Npmjs is a neat package manager for nodejs and other javascript tools and libraries. </span>
      <span class="headline">Most Linux distributions have a prepackaged npm binary. Follow <a href="https://github.com/nodesource/distributions">these instructions</a> if you need help.</span>
      <span class="headline">On Mac OSX, do:</span>
      <pre>brew install node</pre>
      <span class="headline">Do not forget the important part (run it as root):</span>
      <pre>npm -g install succss</pre>
      <div class="tips">Actually, if you are a developer, you can checkout the most recent succss branch and symlink it with the "npm link" command.</div>

      <h2>Python</h2>
      <span class="headline">Python is bundled with Mac OSX and a lot of Linux distributions too. To verify if it is already installed, open your favorite shell and type this:</span>
      <pre>python --version</pre>
      <div class="tips">Succss has been tested with python versions 2.7.8 and 3.4.1, it should work with anything in between.</div>

      <h2>Windows</h2>
      <span class="headline">Argh... Windows. I used to play video games on Windows, I mean, I still do from time to time. Anyway, Windows is not officially supported but theoretically it could work.</span>
      <span class="headline">First, try to get <a href="http://nodejs.org/download/">npm</a> (from nodejs), <a href="https://www.python.org/downloads/windows/">python</a> and <a href="http://casperjs.readthedocs.org/en/latest/installation.html#casperjs-on-windows">casperjs</a> working on Windows, then Succss, you may have it !</span>
    </article>

    <article id="configuration">

      <h1 id="advanced">Advanced Configuration</h1>

      <span class="headline">From the example on the frontpage, you should already know that the succss <a href="/commandline">commandline</a> tool takes <strong>one javascript</strong> file as argument for capturing base screenshots and checking updates for differences with base.</span>
      <pre class="code"><code class="language-javascript">// From data.js (name it what you want)
/* Mandatory */
Succss.pages = {...}
/* Optionnally: */
Succss.viewports = {...}
Succss.setFileName = function(capture) {...}
Succss.callback = function(capture) {...}
Succss.diff = function(imgBase, imgCheck, capture){...}</code></pre>
      <div class="tips">Succss will read the static properties and methods you provide. The callback and diff hook functions are part of the <a href="customize">custom validation</a> facility.</div>
      
      <h2 id="pages">Succss.pages</h2>
      <span class="headline">Succss main configuration is simple: keyed objects representing webpages with captures as name:selector.</span>

      <pre class="code"><code class="language-javascript">Succss.pages = {
  'homepage': {
    url:'succss.ifzenelse.net/configuration?bgColor=673',
    directory:'relative/screenshots/',
    captures: {
      'home':'body',
      'header':'',
      'name-it':'div > #iam a.css #selector'
    }
  }
}
</code></pre>
       <div class="tips">Beware that taking body screenshots is a bad practice: while it's quick to do, it is innefficient and error prone... Which is good to note in this guide.</div>

      <div class="tips">While running succss, pages and captures can be filtered <a href="/commandline#filters">with the --pages and --captures options</a>.</div>
      <ul>
        <li><strong>url</strong>: Protocol is optionnaly specified, default is "http://" . The website for which you will take screenshots.</li>
        <li><strong>directory</strong>: The directory where screenshots will be stored, it can be absolute or relative to your current console path.</li>
        <li id="captures"><strong>captures</strong>: If the selector value is not specified, the name will be used ('header' : '' selector is header, that's how DRY it is)</li>
      </ul>

      <h2 id="before">Before Capture</h2>

      <span class="headline">You may need to automate user interactions <strong>before</strong> capture. Then, you will have to write an object as the capture key's value, this is where is placed the before function.</span>
      <span class="headline">This way, you can use any suite of action supported by CasperJS, notably <a href="http://docs.casperjs.org/en/latest/modules/casper.html#click">click</a>, <a href="http://docs.casperjs.org/en/latest/modules/casper.html#fill">fill</a> and <a href="http://casperjs.readthedocs.org/en/latest/modules/casper.html#wait">wait</a>.</span>

      <pre class="code"><code class="language-javascript">// Example from selftests/data.js (<a href="/fork">@see source code</a>)
Succss.pages = {
...
    captures: {
      'header': {
        // Selectors can have a hook callback "before" capture.
        'before': function() {
          this.click('#logo-image');
          console.log('... Waiting for color squares reinitialization');
          this.wait(900);
        }
      },</code></pre>
      <div class="tips">The 'header' key above is actually the capture's name. The selector, while not explicitly set, is deducted from the name. See below for another example with a selector set.</div>
      <div class="tips"><a href="/fork">Under the hood</a>, capture 'before' function is made with the awesome "call" javascript method, passing the live casper browser instance to your custom capture function. Have a look at the source, it's clean !</div>

      <span class="headline">We can interact further than user input by modifying the DOM. When your interaction alters the Document Object Model, you need to wrap your code inside a casper evaluate() function.</span>
      <pre class="code"><code class="language-javascript">// Example from selftests/data.js (<a href="/fork">@see source</a>)
Succss.pages = {
...
    captures: {
      'header-mod': {
        'selector': 'header',
        before: function() {
          this.evaluate(function() {
            var header = document.getElementsByTagName('header');
            var clickImage = document.getElementById('click-here');
            header[0].removeChild(clickImage);
          });
        }</code></pre>
      <div class="tips">The evaluate function acts on behalf of the client's browser javascript, whereas the code outside is only user input.</div>
      <div class="tips">You can't call console.log from an evaluate function. Nonetheless, you can call the "window.callPhantom()" function with either a string, or {dump:object} (which in turn will call <a href="/customize#tools">utils.dump</a> on your object).</div>

      <span class="headline">If you want to reuse "before" steps on the same page, you can use the first parameter passed to the before function:</span>
      <pre class="code"><code class="language-javascript">        before: function(before) {
          before.header();
          before['header-mod']();
        }</code></pre>
      <div class="tips">The reused before method name will be one of a previous capture on the same page. Be careful not to loop callbacks with this...</div>

      <h2 id="viewports">Succss.viewports</h2>
      <span class="headline">Any number of viewports objects with height and width properties, keyed by viewport names of your choice.</span>
      <pre class="code"><code class="language-javascript">Succss.viewports = {
 'wide':
  {
    'width':1920,
    'height':1200
  },
  'mobile-landscape':
  {
    'width':640,
    'height':480
  }
}</code></pre>
      <div class="tips">Pages and captures can be filtered, likewise viewports have their <a href="/commandline#filters"> --viewports option</a>. If you don't filter viewports, captures will be made for the whole list.</div>

      <h2 id="filename">Succss.setFileName</h2>
      <span class="headline">You can choose the logic behind file naming done by a configuration file, just override the Succss.setFileName function.</span>
      <pre class="code"><code class="language-javascript">Succss.setFileName = function(capture) {
  // Will output something along these lines: "homepage--header--1920x1200.png"
  return capture.page.name + '--' + capture.name + '--' + capture.viewport.width + 'x' + capture.viewport.height + '.png';
};
</code></pre>
      <span class="headline">Following properties are available through the capture Object parameter:</span>
      <ul>
        <li><strong>capture</strong>: name, selector, directory, callback</li>
        <li><strong>capture.page</strong>: name, url, directory</li>
        <li><strong>capture.viewport</strong>: name, width, height</li>
        <li><strong>capture.options</strong>: any <a href="/commandline#options">Succss.options</a> or one given to the commandline</li>
        <li><strong>capture.count</strong>: planned, remaining, failures, startTime</li>
      </ul>
      <div class="tips">Properties of capture.count, namely planned and remaining captures number, current failures number and the execution start timestamp are part of the <a href="customize#capture">custom validation</a> facility.</div>

      <h2 id="default">Default configuration options</h2>
      <span class="headline">Above, we have seen how to take advantage of Succss advanced configuration, it doesn't mean you have to !</span>
      <span class="headline">The following small, yet useful code snippet, outputs full pages screenshots.</span>
      <pre class="code"><code class="language-javascript">// "condensed-conf.js"
Succss.pages = {
  // Will output: './screenshots/home--body--default-viewport.png'
  'home': { url:'succss.ifzenelse.net' },
  // Will output: './screenshots/home--body--default-viewport.png'
  'configuration': { url:'succss.ifzenelse.net/configuration?bgColor=088' }
...
}</code></pre>
      <div class="tips">Obviously, webpage url is mandatory while the directory and selector default to "./screenshots" and "body" respectively. Note that default viewport is 1366x768.</div>

      <span class="headline">From the previous snippet, the following default configuration is assumed:</span>
      <pre class="code"><code class="language-javascript">Succss.pages = {
  'home': {
    url:'succss.ifzenelse.net',
    directory:'./screenshots',
    captures: { 'body':'' }
  },
  'configuration': {
    url:'succss.ifzenelse.net/configuration?bgColor=088',
    directory:'./screenshots',
    captures: { 'body':'' }
  }
}

Succss.viewports = {
 'default': { 'width':1366,'height':768 }
}

Succss.setFileName = function(capture) {
  return capture.page.name + '--' + capture.name + '--' + capture.viewport.name + '-viewport.png';
}</code></pre>

      <h2 id="variables">Variables</h2>
      <span class="headline">DRY (Do not Repeat Yourself). You can avoid repetition with variables.</span>
      <span class="headline">e.g.</span>
      <pre class="code"><code class="language-javascript">var baseUrl = 'succss.ifzenelse.net';

Succss.pages = {
  'home': { url:baseUrl }
  'page1': { url:baseUrl + '/installation' }
  'page2': { url:baseUrl + '/configuration' }
  'pageN': { url:baseUrl + '/customize' }
}</code></pre>
      <div class="tips">Reminder: the Succss configuration is a javascript file.</div>

      <h2 id="source">The source property</h2>
      <span class="headline">The way Javascript assign objects is by reference. It means modifications done on a copied object will get reflected on the original object.</span>
      <span class="headline">To work around this, Succss.pages offers a 'source' attribute to extend another page's properties. For instance:</span>
      <pre class="code"><code class="language-javascript">Succss.pages = {
  'installation': {
    'url': SuccssDataCommon.url+'/installation',
    'directory':SuccssDataCommon.baseDirectory+'/installation',
    captures: {
      'body':'body'
    },
  },
  'configuration': {
    'url': SuccssDataCommon.url+'/configuration',
    'directory':SuccssDataCommon.baseDirectory+'/configuration',
    'source': 'installation'
  }
}
</code></pre>
      <div class="tips">The 'configuration' page above will change the url and directory but keeps the installation 'captures' properties. You could also share the same directory on both.</div>
      <div class="tips"><strong>SuccssDataCommon</strong> is a set of convenient values and functions used for Succss internal testing. Check the <a href="/fork">selftests/data.class.js</a> from the source.</div>

      <h2>Conclusion</h2>
      <span class="headline">Succss configuration is really flexible and powerful, yet simple.</br>
      If you want more examples, skip to <a href="/fork">the source</a> to read the configuration files inside the selftests/ directory.</span>

    </article>

    <article id="commandline">

      <h1>Succss From The CLI (Command Line Interface)</h1>

      <span class="headline">Succss binary is a python script, it will launch casperjs with the <strong>succss-bridge.js</strong> test file. Then, command-line options are read 
        and your javascript configuration file is parsed by the <strong>succss.js</strong> PhantomJS module containing the core Succss logic.</span>
      <span class="headline">Read more below for the really interesting stuff.</span>

      <h2 id="add">Add it</h2>
      <span class="headline">First you will need to write a javascript <a href="/configuration">configuration file</a>, describing pages and selectors on which you want to do the regression testing.</span>
      <pre>succss add your-conf.js</pre>
      <div class="tips">This is how you add reference (base) captures.</div>

      <h2 id="check">Check it</h2>
      <span class="headline">After some time or by continuous integration, you can launch the check command on the same file, or a slightly different one.</span>
      <pre>succss check your-file.js</pre>
      <div class="tips">You may want to have a file for adding and another for testing. While this is done to trigger differences in succss selftests/, just one file is good for most cases.</div>

      <h2 id="filters">Filters</h2>
      <span class="headline"><a href="/configuration#pages">Pages</a>, <a href="/configuration#captures">captures</a> and <a href="/configuration#viewports">viewports</a> from the configuration file can be filtered for any succss run.</span>
      <pre>succss add your-conf.js --pages=p1,p2,p3 --captures=c1,c2 --viewports=v1</pre>
      <div class="tips">Filters are applicable on the <strong>check</strong> command as well.</div>

      <h2 id="engine">Engine</h2>
      <span class="headline">The default browser engine is the PhantomJS headless browser, which is using Webkit (the chrome and safari engine). To render pages with Gecko, first you must have <a href="http://slimerjs.org/">SlimerJS</a> installed on your computer, then run:</span>
      <pre>succss add your-conf.js --engine=slimerjs</pre>
      <pre>succss check your-conf.js --engine=slimerjs</pre>
      <div class="tips">Unlike PhantomJS, SlimerJS is not a headless browser (new desktop windows are created to take screenshots). It will sometimes be more accurate when it comes to display ressources loaded on AJAX requests as well as fonts.</div>
      <div class="tips">The <a href="http://slimerjs.org/download.html#lightweight">lightweight</a> version of SlimerJS can take advantage of your installed Firefox binary.</div>

      <h2 id="diffing">Diffing methods</h2>
      <span class="headline">The default diff image is made with <a href="https://github.com/HumbleSoftware/js-imagediff">js-imagediff</a>.</span>
      <span class="headline">You are not limited to just imagediff, or even a single diff method for one succss check run. A ResembleJS implementation is bundled with succss, to enable it, just do:</span>
      <pre>succss check your-conf.js --resemble</pre>
      <div class="tips">The above will use both ResembleJS and Imagediff, each method will output its own diff image in ./resemble and ./imagediff, respectively.</div>

      <span class="headline">To disable imagediff, you would do:</span>
      <pre>succss check your-conf.js --imagediff=false --resemble</pre>
      <div class="tips">In practice, the prefered way to set the diffing method is with the <a href="/commandline#options">Succss.options</a> object (more on that below).</div>

      <h2 id="casperjs">Additionnal casperjs options</h2>
      <span class="headline">CasperJs <a href="http://casperjs.readthedocs.org/en/latest/modules/casper.html#index-1">options</a> are comaptible with Succss, from the commandline or in the <a href="/commandline#options">Succss.options</a> object.</span>
      <span class="headline">For instance, <a href="http://casperjs.readthedocs.org/en/latest/modules/casper.html#exitonerror">exitOnError</a> and <a href="http://casperjs.readthedocs.org/en/latest/modules/casper.html#waittimeout">waitTimeout</a> are very useful, commonly used options you may need.</span>
      <pre>succss check your-conf.js --exitOnError=false</pre>
      <pre>succss add your-conf.js --waitTimeout=10000</pre>
      <span class="headline">Single string value options are well suited for the commandline, otherwise (for objects like <a href="http://casperjs.readthedocs.org/en/latest/modules/casper.html#pagesettings">pageSettings</a> and <a href="http://casperjs.readthedocs.org/en/latest/modules/casper.html#clientscripts">clientScripts</a>) you can override default options from Succss.options object in the configuration file.</span>
      <div class="tips">When an option is given with no value, true is assumed (see --resemble above).</div>

      <h2 id="options">Succss.options</h2>
      <span class="headline">Commandline options can be avoided by setting "default" options (commandline options take precedence) via the Succss.options object. Beware that the <strong>--engine</strong> option is not compatible with Succss.options.</span>
      <span class="headline">Your default options may look like this:</span>
      <pre class="code"><code class="language-javascript">// your-conf.js
...
Succss.options = {
  'resemble':true,
  'imagediff':false,
  'diffQuality':100,
  'exitOnError':false,
  'pages':'installation,advanced-selectors',
  'pageSettings': {
    'loadImages':false,
    'userName':'login',
    'password':'*xYz*123'
  }
}</code></pre>
      <div class="tips">The username and password from the pageSettings option are used for htaccess authentication.</div>

      <span class="headline">Succss default options are:</span>
      <pre class="code"><code class="language-javascript">// This is actually Succss.allOptions, but you won't have to bother with allOptions.
Succss.options = {
  imgType:'png',
  imgQuality:'80',
  diff:true,
  imagediff:true,
  resemble:false,
  diffQuality:'80',
  tolerancePixels:'0',
};</code></pre>
      <div class="tips">When the diff option is set to true, Succss will search for the user's custom <a href="/customize#diff">Succss.diff</a> function.</div>
      <div class="tips">This snippet is extracted from succss-bridge.js</div>

      <h2 id="settings">Screenshots settings</h2>
      <span class="headline">Captures file type and compression can be set with the following settings:</span>
      <ul>
        <li><strong>imgType</strong>: either jpeg or png. Default is 'png'</li>
        <li><strong>imgQuality</strong>: a number between 0 (worst) and 100 (best, heavier). Default is 80.</li>
      </ul>
      <span class="headline">Diffing also has its settings:</span>
      <ul>
        <li><strong>diffQuality</strong>: a number between 0 (worst) and 100 (best, heavier). Default is 80.</li>
        <li><strong>tolerancePixels</strong>: the tolerance pixels for the imagediff algorithm.</li>
      </ul>
      <div class="tips">To tweak ResembleJS settings, you need to implement your own Succss diff function. It's not that hard, you may read the related <a href="customize#resemble">documentation</a>.</div>

      <h2 id="checkdir">Check against static files</h2>
      <span class="headline">You can choose not to check against live screenshots updates, but to use a custom location that mirrors the reference directory tree. Just use the checkDir option.</span>
      <pre>succss check your-conf.js --checkDir=custom-path</pre>
      <div class="tips">Keep in mind that the checkDir directory tree needs to match directories specified in your-conf.js</div>

      <h2>The LogLevel and verbose options</h2>
      <span class="headline">Casperjs <a href="http://casperjs.readthedocs.org/en/latest/logging.html">verbose and logLevel</a> options provides the ability to display additionnal messages in the console.</span>
      <pre>succss check your-conf.js --verbose --logLevel=info</pre>
      <pre>[info] [phantom] [SucCSS] Options: --imgType=png, --imgQuality=80, --diff=true, --imagediff=false, --resemble=false, --diffQuality=100, --tolerancePixels=0, --exitOnError=false, --pages=installation, --casper-path=/lib/node_modules/casperjs, --cli=true, --dataFile=/home/zen/Projets/Informatique/OpenSource/github/Succss/selftests/data-diff.js, --verbose=true, --logLevel=info, --do=check, --engine=phantomjs</pre>
      <div class="tips">The info log level displays the complete list of currently used options. Available levels, ordered by verbosity, are debug, info, warning and error.</div>

    </article>

    <article id="usecases">

      <h1>Typical use cases</h1>

      <h2>CSS Regression testing</h2>
      <span class="headline">First and foremost, Succss is a CSS Regression testing tool. It will detect and highlight differences between reference and screenshots update taken from web pages and CSS selectors you specify.</span>
      <span class="headline">You can run succss either manually, or automatically with Jenkins, Travis and the like.</span>
      <span class="headline">Expect one of the following messages at the end of a "succss check" run:</span>
      <pre>Tests failed with ' + SuccssCount.failures + ' errors.</pre>
      <pre>[SUCCSS] All captures (' + SuccssCount.planned + ') tests pass!</pre>
      <div class="tips">SuccssCount is used internally to count planned/remaining captures, failures and start time. It is available in the capture object passed as an argument to <a>setFileName</a> and <a>validation</a> functions.</div>

      <h2>Automated design validation</h2>
      <span class="headline">Succss has an option for you to choose the <a href="/commandline#checkdir">base screenshots directory</a>. At a project start, you can set it to a directory with the design images of pages body or CSS selectors.</span>
      <div class="tips">Adjust diff precision with the <a href="/commandline#settings">tolerancePixels</a> option for imagediff, or with a <a href="customize#resemble">custom</a> ResembleJS diff function.</div>

      <h2>Webkit / Gecko comparison</h2>
      <span class="headline">The <a href="/commandline#engine">--engine=Slimerjs</a> commandline option gives the ability to run a Gecko (Firefox) browser to take captures, whereas the default PhantomJS engine is a webkit headless browser. Specify different engines for "succss add" and "succss check" to compare the results. Keep in mind the PhantomJS engine is somewhat limited when it comes to load fonts and/or images on AJAX requests.</span>

      <h2>Visual validation</h2>
      <span class="headline">Screenshots from your website are written in the directory you choose (<a href="/configuration#default">default</a> is ./screenshots). You can open these images manually and detect obvious anomally just by visualizing them <strong>side to side</strong>, especially to quickly compare viewports rendering on a wide range of resolutions (there is also an automated way for this, read more below).</span>

      <h2>Viewports comparison</h2>
      <span class="headline">As stated above, you can compare viewports manually by configuring a <a href="/configuration#viewports">list of viewports</a> to take screenshots with. Otherwise, you can write a configuration overwiting viewports list from another, thanks to <a href="/customize#reuse">phantom.injectJs</a> method, then compare the second to the first. In the second configuration file, you will also need to write a custom setFileName function without dynamic viewport properties for screenshots to be compared.</span>
      <span class="headline">e.g.</span>
      <pre class="code"><code class="language-javascript">// original-conf.js
Succss.pages = { ...
Succss.viewports = {
  // One or several viewports objects.
  ...
  // The viewport your want to check against.
  'wide' =  {
    height: 1920,
    width: 1200
  }
}
// You can keep the default setFileName, which is:
//Succss.setFileName = function(capture) {
//  return captureState.page.name + '--' + captureState.name + '--' + captureState.viewport.name + '-viewport.png';
//}
</code></pre>
<pre class="code"><code class="language-javascript">// second-conf.js
phantom.injectJs(fs.workingDirectory + '/mypath/original-conf.js');
// Do not overwrite pages, only viewports and setFileName
Succss.viewports = {
  // The list of viewports to check against one viewport from original-conf.js
  viewportA =  {...}
  viewportB =  {...}
  viewportC =  {...}
}
Succss.setFileName = function() {
  // Set a filename similar to the original-conf.js, only freeze the viewport:
  return captureState.page.name + '--' + captureState.name + '--' + 'wide-viewport.png';
}
</code></pre>
      <span class="headline">With the above, "succss check second-conf.js" will check A,B and C viewports against the 'wide' viewport from original-conf.js.</span>
      <div class="tips">Succss Imagediff's and ResembleJS's default implementations write diff images in a <a>directory tree</a> starting with the capture start time timestamp, then the checked page and viewport identifier, then the reference's directory tree. The filename will be the reference's one. In short, diff images will never be erased due to improper setFileName usage (while references screenshots can be overwritten) unless you write your <a href="customize#diff">own diff</a> implementation.</div>

      <h2>Pages comparison</h2>
      <span class="headline">You can extend the preceding viewports checking logic to pages. First, <a href="configuration#source">"source"</a> the pages you want to compare, then freeze the page segment of filenames, like so:</span>
      <pre class="code"><code class="language-javascript">// original-conf.js
Succss.pages = {
  // Original page for comparison.
  'installation': {
    'url': SuccssDataCommon.url+'?page=installation&variation=0',
    captures: {
      'body':'body'
    },
  },
}
</code></pre>
<pre class="code"><code class="language-javascript">// second-conf.js
phantom.injectJs(fs.workingDirectory + '/mypath/original-conf.js');
// Do not overwrite pages, only viewports and setFileName
Succss.pages = {
  'commandline': {
    'url': SuccssDataCommon.url+'?page=commandline',
    'source': 'installation'
  },
  'fork': {
    'url': SuccssDataCommon.url+'?page=fork',
    'source': 'installation'
  }
}
Succss.setFileName = function() {
  // We force comparison to the reference 'installation' screenshot regardless of the updated page name:
  return 'installation' + '--' + captureState.name + '--' + captureState.viewport.name + '-viewport.png';
}
</code></pre>
      <span class="headline">Now, "succss check second-conf.js" will compare body screenshots of pages 'commandline' and 'fork' to the 'installation' page body.</span>
      <div class="tips">You can compare viewports and pages at the same time, just freeze both in the filename. See how it's done in <a href="/fork">selftests/data-compare.js</a>.</div>

      <h2>History versionning</h2>
      <span class="headline">Plain and simple. With a version management system like Git, keep records of your website design and integration changes through time.</span>

    </article>

    <article id="why">
      |------- ------------------------------------------------------------------------------------<br/>
      |------- &nbsp;&nbsp;&nbsp;Written by B2F, on 16 January 2015.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
      |------- ------------------------------------------------------------------------------------<br/>

      <h1>Why another CSS regression testing tool ?</h1>

      <span class="headline">At the time of writing, there is three other tools I know of: PhantomCSS, BackstopJS and CSS Critics (MIT licenses).</span>

      <h2>Why Succss over <a href="https://github.com/Huddle/PhantomCSS">PhantomCSS</a> ?</h2>
      <span class="headline">To sum up: Easier to learn, faster to deploy, yet as flexible.</span>
      <span class="headline">PhantomCSS is a code library on top of PhantomJS, CasperJS, ResembleJS. It takes a classic casperjs test file and run, providing a phantomcss object to it. Mostly these methods:</span>
      <pre class="code">phantomcss.init({//...})<code class="language-javascript"></code></pre>
      <div class="tips">PhantomCSS "constructor" taking an object as parameter to choose directories, file names, resemblejs properties and such.</div>
      <pre class="code">phantomcss.screenshot<code class="language-javascript"></code></pre>
      <div class="tips">PhantomCSS method for taking screenshots (phantomcss.screenshot("#CSS .selector", screenshotName))</div>
      <pre class="code"><code>phantomcss.compareAll('exclude.test');
phantomcss.compareMatched('include.test', 'exclude.test')
phantomcss.compareMatched( new RegExp('include.test'), new RegExp('exclude.test'));

/* Compare image diffs generated in this test run only */
phantomcss.compareSession();

/* Explicitly define what files you want to compare*/
phantomcss.compareExplicit(['/dialog.diff.png', '/header.diff.png']);

/* Get a list of image diffs generated in this test run */
phantomcss.getCreatedDiffFiles();

/* Compare any two images, and wait for the results to complete */
phantomcss.compareFiles(baseFile, diffFile);
phantomcss.waitForTests();</code></pre>
      <div class="tips">Methods for comparing screenshots.</div>
      <span class="headline">Before starting PhantomCSS, one must know how to use casperjs (mind your learning curve), and then choose his/her complete workflow made of potentially asynchronous calls for opening webpages (for beginners, it can quickly become a mess, difficult to read and debug). </span>
      <span class="headline">PhantomCSS is a casperjs module. CasperJS beeing a web scraping, functionnal testing tool, it makes sense. However, Succss is a tool built *on top* of casperjs, thus abstracting it to the user for the most part.</span>
      <span class="headline">With PhantomCSS, starting almost from scratch ("Compare the images when and how you want" - from its github page), you may duplicate code for each of your captures (add phantomcss.screenshot calls to casperjs requests, you will likely get a verbose source) across test suites if any. You will write different files for captures and diffing, unless you add processing logic on top of it - that is why I went my own route for Succss.</span>
      <span class="headline">Also when diffing with Succss, you can not only use ResembleJS but also ImageDiff (the default), or <a href="/customize#diff">anything else</a> you come up with. Conclusion: Succss has all the complex logic and underliying code done for you, and you will still be able to do advanced interactions by writing callbacks <a href="configuration#before">before</a> captures.</span>
      <span class="headline">It's worth to mention that the company supporting both PhantomCSS and <strong>ResembleJS</strong> research and development is <a href="http://www.huddle.com/home/">Huddle</a>. Credits to them for pioneering the CSS Regression tools.</span>
     
      <h2>Why Succss over <a href="https://garris.github.io/BackstopJS">BackstopJS</a> ?</h2>
      <span class="headline">First, I started Succss development shortly before BackstopJS came out, so I may not have done it if it came out sooner.</span>
    <span class="headline">BackstopJS rely heavily on Gulp and its commandline, now what is gulp ?</span>
    <span class="headline">If you don't know what it is or don't want to get yet something else 
    for just that one specific task (CSS regression testing), that may be annoying.</span>
    <span class="headline">At the time of writing, BackstopJS uses json files (syntactically rigid) as its data configuration,
      whereas Succss uses javascript files. The later can take advantage of variables (<a href="/configuration#variables">for DRY sake</a>) 
    and give you access to callbacks before and <a href="customize#callback">after</a> taking screenshots (either captures from adding references or checking updates).</span>
    <span class="headline">Also, BackstopJS has a per project Bower library (Gulp and Casperjs dependencies are not resolved with Bower), whereas Succss is a npm global. I wouldn't call it quick to get if you never used Bower and Gulp before.</span>
    <span class="headline">BackstopJS make it clear that it is "basically a wrapper around the very fabulous Resemble.js", therefore not compatible with <a href="commandline#diffing">imagediff</a> .</span>

    <h2>Why Succss over <a href="https://github.com/cburgmer/csscritic">CSS Critic</a> ?</h2>
    <span class="headline">It seems that there is a lot of CSS Regression testing tools getting released these days !</span>
    <span class="headline">I don't know much about CSS Critic, I read about it lately on the imagediff users list.</span>
    <span class="headline">Among other limitations listed on the CSS Critic's github page, I can tell that it uses a mandatory "RegressionRunner.html" file runnable with firefox only.</span>

    <h2>Succss is complete, with a smooth learning curve.</h2>
    <span class="headline">Succss is a complete CSS regression testing tool having
    its own executable rather than something else ("casperjs test", "gulp"),
    it's easy to learn, easy to install and fast to use. If you're into CSS regression testing,
give it a try !</span>
    </article>

    <article id="customize">

     <h1>Custom validations</h1>

     <h2 id="callback">After capture (Succss.callback)</h2>
     <span class="headline">Beyond checking if base and update screenshots match, you can add custom assertions after each capture is taken. The optionnal Succss.callback hook function in your configuration file serve this purpose.</span>
     <span class="headline">In the following example, an error is thrown if captures updates match images references, unless a custom --good option is passed to the script (notice capture.options.good):</span>
     <pre class="code"><code class="language-javascript">// This function will be called after each screenshot is taken.
Succss.callback = function(capture) {

  // The other available action is 'add'
  if (capture.action == 'check') {

    if (!capture.options.good) {
      casper.test.assertTruthy(fs.exists(capture.filePath), 'The updated capture was taken (' + capture.filePath + ').');
      casper.test.assertNotEquals(fs.size(capture.filePath), fs.size(capture.basePath), 'Base and update are different in size.');
    }
  }
}</code></pre>
    <div class="tips">The code snippet above is actually inspired from succss source, where image differences are triggered (<a href="/fork">@see selftests/data-diff.js</a>).</div>
    <div class="tips">The <a href="/customize#capture">capture</a> parameter, casper.test and fs <a href="/customize#tools">objects</a> are all explained below.</div>
    <span class="headline">To deactivate the above custom assertions, you would do:</span>
    <pre>succss check your-conf.js --good</pre>

    <h2 id="diff">Custom diff (Succss.diff)</h2>
    <span class="headline">In the previous <a href="/customize#callback">Succss.callback</a> example, we actually inverted the default checking behavior: it fails if no difference is found. But while Succss.callback is used to add assertions, it doesn't change nor remove assertions from the diff method.</span>
    <span class="headline">The <strong>Succss.diff</strong> function is hooked later than Succss.callback, only when "succss check" run. Particularly, base and updated html images, as well as the full capture object are loaded as parameters.</span>
    <span class="headline">Following the preceding Succss.callback example, here is a Succss.diff function written to change the diffing assertion.</span>
    <pre class="code"><code class="language-javascript">/*
 * Adds a diff function, replicating Succss's imagediff function but changing path and assertion.
 */
Succss.diff = function(imgBase, imgCheck, capture) {

    phantom.injectJs('lib/imagediff.js');

    imgDiff = imagediff.diff(imgBase, imgCheck);
    var imagesMatch = imagediff.equal(imgBase, imgCheck, capture.options.tolerancePixels);

    if (!imagesMatch) {
      var filePath = capture.filePath.replace('.succss-tmp/', './selftests/diff-screenshots/');
      this.writeImgDiff(imgDiff, imgBase, imgCheck, filePath);
    }

    casper.test.assertFalse(imagesMatch, 'Capture is different to base screenshot (imagediff).');
}</code></pre>
     <div class="tips">The default imagediff (actually this.imagediff function below) behavior will still run, unless you set the imagediff option to false. From <a href="/commandline#diffing">commandline</a> or <a href="/commandline#options">Succss.options</a>, imagediff, resemble and diff are available options.</div>
 
     <span class="headline">Here, "this" is a reference to the succss.js module's object. It has the three following methods of interest:</span>
     <ul>
       <li><strong>this.imagediff(imgBase, imgUpdate, capture)</strong>: calls the bundled imagediff implementation (do not confound Succss this.imagediff and the above imagediff.diff function from lib/imagediff.js).</li>
       <li><strong>this.resemble(imgBase, imgUpdate, capture)</strong>: calls the bundled resemble implementation.</li>
       <li><strong>this.writeImgDiff(imgDiff, imgBase, imgCheck, filePath)</strong>: the writeImgDiff function creates a <a href="home#differences">HTML canvas</a> with the three html images arguments provided and write the resulting file to the filePath location.</li>
     </ul>
     <div class="tips">If you understood correctly, you guessed that both this.imagediff and this.resemble call this.writeImgDiff internally (<a href="/fork">@see succss.js</a>).</div>
     <span class="headline" id="resemble">The next Succss.diff example is extending <a href="https://github.com/Huddle/Resemble.js">ResembleJS</a> default settings:</span>
     <pre class="code"><code class="language-javascript">Succss.diff = function(imgBase, imgCheck, capture) {

    phantom.injectJs('lib/resemble.js');

    resemble.outputSettings({
      errorColor: {
        red: 255,
        green: 0,
        blue: 255
      },
      errorType: 'movement',
      transparency: 0.3,
      largeImageThreshold: 1200
    });

    this.resemble(imgBase, imgCheck, capture);

};</code></pre>
    <div class="tips">The <strong>phantom.injectJs</strong> path is relative to your succss-bridge.js directory (most likely somewhere close to your node_modules). It means you will always have access to lib/resemblejs and lib/imagediff without adding them manually. You can specify a path relative to the console directory by prefixing it with fs.workingDirectory + '/...'</div>

      <h2 id="capture">The capture parameter</h2>
      <span class="headline">The capture object is similar to the one available in <a href="/configuration#filename">Succss.setFileName</a>:</span>
      <ul>
        <li><strong>capture</strong>: name, selector, directory, callback</li>
        <li><strong>capture.page</strong>: name, url, directory</li>
        <li><strong>capture.viewport</strong>: name, width, height</li>
        <li><strong>capture.options</strong>: any <a href="/commandline#options">Succss.options</a> or one given to the commandline</li>
        <li><strong>capture.count</strong>: planned, remaining, failures, startTime</li>
      </ul>
      <div class="tips">capture.count properties are especially useful when errors are thrown. Also, SuccssDataCommon.assertSuiteSuccess from <a href="/fork">selftests/data.class.js</a> is a good example.</div>
      <span class="headline">With these extra parameters:</span>
      <ul>
        <li><strong>capture.file</strong>: the filename from Succss.setFileName</li>
        <li><strong>capture.basePath</strong>: the path of base screenshot (the one created with "succss add")</li>
        <li><strong>capture.filePath</strong>: the path of the current screenshot capture (same as basePath on a "succss add" run).</li>
        <li><strong>capture.action</strong>: the current succss command, either 'add' or 'check'.</li>
      </ul>
      <div class="tips">Filename and succss command are not set when Succss.setFileName is called, hence the unavailability of the extras parameters.</div>

      <h2 id="tools">Available objects</h2>
      <span class="headline">To take advantage of PhantomJS and CasperJS modules available in Succss, take a look at their documentations:</span>
      <ul>
        <li><strong>phantom</strong>: the <a href="http://phantomjs.org/api/phantom/">phantom Object</a> from PhantomJS</li>
        <li><strong>fs</strong>: the <a href="http://phantomjs.org/api/fs/">File System Module</a> from PhantomJS</li>
        <li><strong>colorizer</strong>: the <a href="http://casperjs.readthedocs.org/en/latest/modules/colorizer.html">colorizer module</a> from CasperJS</li>
        <li><strong>utils</strong>: the <a href="http://casperjs.readthedocs.org/en/latest/modules/utils.html">utils module</a> from CasperJS</li>
        <li><strong>casper.test</strong>: the <a href="http://casperjs.readthedocs.org/en/latest/modules/tester.html">tester module</a> from CasperJS</li>
      </ul>
      <div class="tips">You can use Succss this.echo(message, type) shortcut to print console logs with the CasperJS colorizer module.</div>

      <h2 id="reuse">Custom validations reuse</h2>
      <span class="headline">You can reuse your own validation logic across configuration files. To include javascript files, do the following:</span>
      <pre class="code"><code class="language-javascript">phantom.injectJs(fs.workingDirectory + '/selftests/data.class.js');</code></pre>
      <div class="tips">The selftests/data.class.js file is a set of common functions and values used across Succss selftests</div>
      <div class="tips">The javascript file injection can be used to factor any part of a configuration file, not only the validation process but also for <a href="/configuration#source">sourcing</a> Succss pages from another file.</div>

    </article>

    <article id="fork">

      <h1>Fork Succss on Github !</h1>
      <iframe src="http://ghbtns.com/github-btn.html?user=mdo&repo=github-buttons&type=fork&size=large"
  allowtransparency="false" frameborder="0" scrolling="0" width="95" height="30"></iframe>
      <iframe src="http://ghbtns.com/github-btn.html?user=mdo&repo=github-buttons&type=watch&size=large"
  allowtransparency="false" frameborder="0" scrolling="0" width="95" height="30"></iframe>

    <span class="headline">Succss commandline tool:</span>
    <ul>
      <li><a href="https://github.com/B2F/Succss" style="background-color:transparent;font-weight:bold;color:white;">https://github.com/B2F/Succss</a></li>
    </ul>
    <span class="headline">This website:</span>
    <ul>
      <li><a href="https://github.com/B2F/Succss-doc" style="background-color:transparent;font-weight:bold;color:white;">https://github.com/B2F/Succss-doc</a></li>
    </ul>

    </article>

      <div id="more-infos">
        <span class="headline" id="more-infos-headline">Do you want more infos ?</span>
        <div id="more-infos-links">
          <a href="/usecases">.) Typical Use Cases</a>
          <a href="/installation">.) Installation Troubleshooting</a>
          <a href="/configuration">.) Advanced Configuration</a>
          <a href="/commandline">.) Succss from the CLI</a>
          <a href="/customize">.) Custom Validations</a>
          <a href="/why">.) Why another CSS Regression Testing Tool ?</a>
          <a href="/fork">.) Succss, at its Source !</a>
          <a href="/home">--- Home Page</a>
        </div>
      </div>

  </div>

  <aside id="colors"></aside>

  <footer id="supporters">
    <h3>Support this</h3>
    <span class="headline"><a href="/home">Succss CSS regression testing tool</a> is free and Open Source (MIT License). I won't ask you to *buy* Succss. However, if you use the tool (big companies, if you ever do this is for you too), like the documentation or this website, you can show your support by spreading the news, contributing to the source and issue queue or, donating with the button below:</span>
    <span class="headline">With a common agreement, I'll update the list below with supporters names and links, ordered by the weight of their contribution - starting with me (hey, this took my time and ideas after all).</span>
    <ul>
      <li><a href="http://ifzenelse.net/b2f"><span>B2F from ifzenelse.net - the original Succss author.</span><img src="img/ifzenelse/logo_04.png"/></a></li>
    </ul>
  </footer>
</body>
</html>
