<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>SUCCSS: the CSS regression testing tool</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">

  <link rel="icon" href="/favicon.ico" type="image/x-icon" />
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />

  <link rel="stylesheet" href="css/styles.css">
  <script type="text/javascript" src="js/color-squares.js"></script>
  <link rel="stylesheet" href="css/twitter.css">

  <script type="text/javascript" src="js/prism.js"></script>
  <link rel="stylesheet" href="css/prism.css">

  <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:700' rel='stylesheet' type='text/css'>

</head>

<body>

  <a id="fork-on-github" href="https://github.com/you"><img style="position: fixed; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png"></a>

  <header>
    <a href="/index.html" title="home"><span id="logo">SUCCSS</span></a>
    <img id="logo-image" src="img/arc-logo.png"/><img width="161" id="click-here" src="img/click-here.png"/>
    <div id="header-text">
      <span id="static-line">Succss! Easy to install, easy to use CSS regression testing tool.<br/></span>
      <span id="dynamic-line">Turn your <strong>C</strong>ascading <strong>S</strong>tlye<strong>S</strong>heets into <strong>success</strong>ful design integrations.</span>
    </div>
    <a href="" id="twitter-button" title="Found the hidden GET params meaning yet ? Tweak it ! Share a customised version of this page."><i></i><span class="label">Tweet</span></a>
  </header>

  <div id="core">

    <article id="home">

      <span class="headline">Grab it:</span>
      <pre>npm install -g succss</pre>
      <div class="tips">Succss rely on <a href="http://phantomjs.org/" target="_blank">PhantomJS</a> and <a href="http://casperjs.org/" target="_blank">CasperJS</a> dependencies, automatically resolved by npm. Follow <a href="/installation">this guide</a> if you have trouble with npm.</div>

      <span class="headline">Describe your website CSS:</span>
      <pre class="code" style="height:500px;"><code class="language-javascript">//data.js
Succss.pages = {
  'any webpage': {
    url:'succss.ifzenelse.net',
    directory:'screenshots',
    captures: {
      // Key:name Value:CSS selector.
      'header':'header',
      'square1':'#red.color-square',
      'square2':'#green.color-square',
      'square3':'#blue.color-square'
    },
  },
  'another one': { 
    ... 
  }
};

Succss.viewports: {
  'classic wide': {
    width: 1366,
    height: 768
  },
  'mobile': {
    width: 320,
    height: 480
  },
  ...
}</code></pre>

      <div class="tips">Succss can be used in many ways, for many use cases.
        Later, you can also read <a href="/configuration">Advanced Configuration</a>.</div>

      <span class="headline">Take base screenshots:</span>
      <pre><code>succss add data.js</code></pre>
      <div class="tips">For advanced usage, the command line tool can additionally take several options 
      such as pages, captures and viewports <a href="/commandline#filters">filters</a>.</div>

      <span class="headline">Compare base screenshots to updates:</span>
      <pre><code>succss check data.js</code></pre>
      <div class="tips">Succss is bundled with imagediff (default) and ResembleJS for comparisons. You can also fully <a href="customize">customize</a> captures validations.</div>

      <span class="headline" id="differences">See differences or success:</span>
      <pre><img src="img/screenshots/imagediff.jpeg"/></pre>
      <div class="tips">This image extracted from selftests displays how differences are highlighted by <a href="https://github.com/HumbleSoftware/js-imagediff">Imagediff</a>. Take a look at <a href="/fork">Succss source code</a> if you know javascript.</div>

    </article>

    <article id="installation">

      <h1>Installation Troubleshooting</h1>

      <h2>Requirements</h2>
      <span class="headline">There is only two simple requirements to get Succss and to run it.</span>
      <ul>
        <li>1. how to get Succss ? <strong><a href="https://www.npmjs.com/">npm</a></strong> </li>
        <li>2. how to run it ? <strong><a href="https://www.python.org/">python</a></strong></li>
      </ul>
      <div class="tips">You could checkout the Succss git repository, symlink it's binary to your system and have CasperJS installed separately, but well... who would do that ?</div>

      <h2>npm</h2>
      <span class="headline">Npmjs is a neat package manager for nodejs and other javascript tools and libraries. </span>
      <span class="headline">Most Linux distributions have a prepackaged npm binary. Follow <a href="https://github.com/nodesource/distributions">these instructions</a> if you need help.</span>
      <span class="headline">On Mac OSX, do:</span>
      <pre>brew install node</pre>
      <span class="headline">Do not forget the important part (run it as root):</span>
      <pre>npm -g install succss</pre>
      <div class="tips">Actually, if you are a developer, you can checkout the most recent succss branch and symlink it with the "npm link" command.</div>

      <h2>Python</h2>
      <span class="headline">Python is bundled with Mac OSX and a lot of Linux distributions too. To verify if it is already installed, open your favorite shell and type this:</span>
      <pre>python --version</pre>
      <div class="tips">Succss has been tested with python versions 2.7.8 and 3.4.1, it should work with anything in between.</div>

      <h2>Windows</h2>
      <span class="headline">Argh... Windows. I used to play video games on Windows, I mean, I still do from time to time. Anyway, Windows is not officially supported but theoretically it could work.</span>
      <span class="headline">First, try to get <a href="http://nodejs.org/download/">npm</a> (from nodejs), <a href="https://www.python.org/downloads/windows/">python</a> and <a href="http://casperjs.readthedocs.org/en/latest/installation.html#casperjs-on-windows">casperjs</a> working on Windows, then Succss, you may have it !</span>
    </article>

    <article id="configuration">

      <h1 id="advanced">Advanced Configuration</h1>

      <span class="headline">From the example on the frontpage, you should already know that the succss <a href="/commandline">commandline</a> tool takes <strong>one javascript</strong> file as argument for capturing base screenshots and checking updates for differences with base.</span>
      <pre class="code"><code class="language-javascript">// From data.js (name it what you want)
/* Mandatory */
Succss.pages = {...}
/* Optionnally: */
Succss.viewports = {...}
Succss.setFileName = function(capture) {...}
Succss.callback = function(capture) {...}
Succss.diff = function(imgBase, imgCheck, capture){...}</code></pre>
      <div class="tips">Succss will read the static properties and methods you provide. The callback and diff methods are part of the <a href="customize">custom validation</a> facility.</div>
      
      <h2 id="pages">Succss.pages</h2>
      <span class="headline">Succss main configuration is simple: keyed objects representing webpages with captures as name:selector.</span>

      <pre class="code"><code class="language-javascript">Succss.pages = {
  'homepage': {
    url:'succss.ifzenelse.net/configuration?bgColor=673',
    directory:'relative/screenshots/',
    captures: {
        'home':'body',
        'header':'',
        'name-it':'div > #iam a.css #selector'
    }
  }
}
</code></pre>
       <div class="tips">Beware that taking body screenshots is a bad practice: while it's quick to do, it is innefficient and error prone... Which is good to note in this guide.</div>

      <div class="tips">While running succss, pages and captures can be filtered <a href="/commandline#filters">with the --pages and --captures options</a>.</div>
      <ul>
        <li><strong>url</strong>: Protocol is optionnaly specified, default is "http://" . The website for which you will take screenshots.</li>
        <li><strong>directory</strong>: The directory where screenshots will be stored, it can be absolute or relative to your current console path.</li>
        <li id="captures"><strong>captures</strong>: If the selector value is not specified, the name will be used ('header' : '' selector is header, that's how DRY it is)</li>
      </ul>

      <h2 id="before">Before Capture</h2>

      <span class="headline">You may need to automate user interactions <strong>before</strong> capture. Then, you will have to write an object as the capture key's value, this is where is placed the before function.</span>
      <span class="headline">This way, you can use any suite of action supported by CasperJS, notably <a href="http://docs.casperjs.org/en/latest/modules/casper.html#click">click</a>, <a href="http://docs.casperjs.org/en/latest/modules/casper.html#fill">fill</a> and <a href="http://casperjs.readthedocs.org/en/latest/modules/casper.html#wait">wait</a>.</span>

      <pre class="code"><code class="language-javascript">// Example from selftests/data.js (<a href="/fork">@see source code</a>)
Succss.pages = {
...
    captures: {
      'header': {
        // Selectors can have a hook callback "before" capture.
        'before': function() {
            this.click('#logo-image');
            console.log('... Waiting for color squares reinitialization');
            this.wait(900);
        }
      },</code></pre>
      <div class="tips">The 'header' key above is actually the capture's name. The selector, while not explicitly set, is deducted from the name. See below for another example with a selector set.</div>
      <div class="tips"><a href="/fork">Under the hood</a>, capture 'before' function is made with the awesome "call" javascript method, passing the live casper browser instance to your custom capture function. Have a look at the source, it's clean !</div>

      <span class="headline">We can interact further than user input by modifying the DOM. When your interaction alters the Document Object Model, you need to wrap your code inside a casper evaluate() function.</span>
      <pre class="code"><code class="language-javascript">// Example from selftests/data.js (<a href="/fork">@see source</a>)
Succss.pages = {
...
    captures: {
      'header-mod': {
        'selector': 'header',
        before: function() {
          this.evaluate(function() {
            var header = document.getElementsByTagName('header');
            var clickImage = document.getElementById('click-here');
            header[0].removeChild(clickImage);
          });
        }</code></pre>
      <div class="tips">The evaluate function acts on behalf of the client's browser javascript, whereas the code outside is only user input.</div>
      <div class="tips">You can't call console.log from an evaluate function. Nonetheless, you can call the "window.callPhantom()" function with either a string, or {dump:object} (which in turn will call <a href="/customize#tools">utils.dump</a> on your object).</div>

      <span class="headline">If you want to reuse "before" steps on the same page, you can use the first parameter passed to the before function:</span>
      <pre class="code"><code class="language-javascript">        before: function(before) {
          before.header();
          before['header-mod']();
        }</code></pre>
      <div class="tips">The reused before method name will be one of a previous capture on the same page. Be careful not to loop callbacks with this...</div>

      <h2 id="viewports">Succss.viewports</h2>
      <span class="headline">Any number of viewports objects with height and width properties, setting the browser height and width before each capture is done. Keyed by viewport names of your choice.</span>
      <pre class="code"><code class="language-javascript">Succss.viewports = {
 'wide':
  {
    'width':1920,
    'height':1200
  },
  'mobile-landscape':
  {
    'width':640,
    'height':480
  }
}</code></pre>
      <div class="tips">Pages and captures can be filtered, likewise viewports have their <a href="/commandline#filters"> --viewports option</a>.</div>

      <h2 id="filename">Succss.setFileName</h2>
      <span class="headline">You can choose the logic behind file naming done in a configuration file, just override the Succss.setFileName function.</span>
      <pre class="code"><code class="language-javascript">Succss.setFileName = function(capture) {
  // Will output something along these lines: "homepage--header--1920x1200.png"
  return capture.page.name + '--' + capture.name + '--' + capture.viewport.width + 'x' + capture.viewport.height + '.png';
};
</code></pre>
      <span class="headline">Following properties are available through the capture Object parameter:</span>
      <ul>
        <li><strong>capture</strong>: name, selector, directory, callback</li>
        <li><strong>capture.page</strong>: name, url, directory</li>
        <li><strong>capture.viewport</strong>: name, width, height</li>
        <li><strong>capture.options</strong>: any <a href="/commandline#options">Succss.options</a> or one given to the commandline</li>
        <li><strong>capture.count</strong>: planned, remaining, failures, startTime</li>
      </ul>
      <div class="tips">Properties of capture.count, namely planned and remaining captures, current failures number and startTime are part of the <a href="customize#capture">custom validation</a> facility.</div>

      <h2>Default configuration options</h2>
      <span class="headline">Above, we have seen how to take advantage of Succss advanced options, it doesn't mean you have to !</span>
      <span class="headline">The following code snippet, much smaller, outputs a simple body screenshot.</span>
      <pre class="code" style="height:165px;"><code class="language-javascript">Succss.pages = {
  // Will output: './screenshots/body--default-viewport.png'
  'home': { url:'succss.ifzenelse.net/configuration?bgColor=088' }
}</code></pre>
      <div class="tips">Obviously, webpage url is mandatory while the directory and selector default to "./screenshots" and "body", respectively. Note that default viewport is 1366x768.</div>

      <span class="headline">From the previous snippet, the following default configuration is assumed:</span>
      <pre class="code"><code class="language-javascript">Succss.pages = {
  'home': {
    url:'succss.ifzenelse.net/configuration?bgColor=110',
    directory:'./screenshots',
    captures: { 'body':'' }
  }
}

Succss.viewports = {
 'default': { 'width'1366,'height'768 }
}

Succss.setFileName = function(capture) {
  return capture.name + '--' + capture.viewport.name + '-viewport.png';
}</code></pre>

      <h2 id="variables">Variables</h2>
      <span class="headline">Last but not least, you can avoid repetition with variables.</span>
      <span class="headline">e.g.</span>
      <pre class="code"><code class="language-javascript">var baseUrl = 'succss.ifzenelse.net';

Succss.pages = {
  'home': { url:baseUrl }
  'page1': { url:baseUrl + '/installation' }
  'page2': { url:baseUrl + '/configuration' }
  'pageN': { url:baseUrl + '/customize' }
}</code></pre>
      <div class="tips">Reminder: the Succss configuration is a javascript file.</div>

      <h2>Conclusion</h2>
      <span class="headline">Succss configuration is really flexible and powerful, yet simple.</br>
      If you want more examples, skip to <a href="/fork">the source</a> to read the configuration files inside the selftests/ directory.</span>

    </article>

    <article id="commandline">

      <h1>Master Succss Commandline</h1>
    </article>

    <article id="usecases">

      <h1>Typical use cases</h1>
    </article>

    <article id="why">

      <h1>Why another CSS regression testing tool ?</h1>

      <span class="headline">At the time of writing, there is three other tools I know of: PhantomCSS, BackstopJS and CSS Critics (MIT licenses).</span>

      <h2>Why Succss over <a href="https://github.com/Huddle/PhantomCSS">PhantomCSS</a> ?</h2>
      <span class="headline">To sum up: Easier to learn, faster to deploy, yet as flexible.</span>
      <span class="headline">PhantomCSS is a code library on top of PhantomJS, CasperJS, ResembleJS. It takes a classic casperjs test file and run, providing a phantomcss object to it. Mostly these methods:</span>
      <pre class="code">phantomcss.init({//...})<code class="language-javascript"></code></pre>
      <div class="tips">PhantomCSS "constructor" taking an object as parameter to choose directories, file names, resemblejs properties and such.</div>
      <pre class="code">phantomcss.screenshot<code class="language-javascript"></code></pre>
      <div class="tips">PhantomCSS method for taking screenshots (phantomcss.screenshot("#CSS .selector", screenshotName))</div>
      <pre class="code"><code>phantomcss.compareAll('exclude.test');
phantomcss.compareMatched('include.test', 'exclude.test')
phantomcss.compareMatched( new RegExp('include.test'), new RegExp('exclude.test'));

/* Compare image diffs generated in this test run only */
phantomcss.compareSession();

/* Explicitly define what files you want to compare*/
phantomcss.compareExplicit(['/dialog.diff.png', '/header.diff.png']);

/* Get a list of image diffs generated in this test run */
phantomcss.getCreatedDiffFiles();

/* Compare any two images, and wait for the results to complete */
phantomcss.compareFiles(baseFile, diffFile);
phantomcss.waitForTests();</code></pre>
      <div class="tips">Methods for comparing screenshots.</div>
      <span class="headline">Before understanding PhantomCSS, one must know how to use casperjs (mind your learning curve), and then choose his/her complete workflow made of potentially asynchronous calls for opening webpages (for beginners, it can quickly become a mess, difficult to read and debug). </span>
      <span class="headline">PhantomCSS is a casperjs module. CasperJS beeing a web scraping, functionnal testing tool, it makes sense. However, Succss is a command line tool built *on top* of casperjs, thus abstracting it to the user.</span>
      <span class="headline">With PhantomCSS, starting almost from scratch ("Compare the images when and how you want" - from its github page), you may duplicate code for each of your captures (add phantomcss.screenshot calls to casperjs requests, you will likely get a verbose source) across test suites if any. You will write different files for captures and diffing, unless you code yet another tool on top of it - that is why I went my own route for Succss.</span>
      <span class="headline">Also when diffing with Succss, you can not only use ResembleJS but also ImageDiff (the default), or <a href="/customize">anything else you come up with</a>. Conclusion: Succss has all the complex logic and underliying code done for you, and you will still be able to do advanced interactions by <a href="configuration">writing callbacks before captures</a>.</span>
      <span class="headline">It's worth to mention that the company supporting both PhantomCSS and <strong>ResembleJS</strong> research and development is <a href="http://www.huddle.com/home/">Huddle</a>. Credits to them for pioneering the CSS Regression tools.</span>
     
      <h2>Why Succss over <a href="https://garris.github.io/BackstopJS">BackstopJS</a> ?</h2>
      <span class="headline">First, I started Succss development shortly before BackstopJS came out, so I may not have done it if it came out sooner.</span>
    <span class="headline">BackstopJS rely heavily on Gulp and its commandline, now what is gulp ?</span>
    <span class="headline">If you don't know what it is or don't want to get yet something else 
    for just that one specific task (CSS regression testing), that may be anoying.</span>
    <span class="headline">At the time of writing, BackstopJS uses json files (syntactically rigid) as its data configuration,
    whereas Succss uses javascript files. The later can take advantage of variables (for DRY sake) 
    and give you access to callbacks before and after taking screenshots (for both base and updates).</span>
    <span class="headline">Also, BackstopJS has a per project Bower library (Gulp and Casperjs dependencies are not resolved with Bower), whereas Succss is a npm global. I wouldn't call it quick to get if you never used Bower and Gulp before.</span>
    <span class="headline">BackstopJS make it clear that it is "basically a wrapper around the very fabulous Resemble.js", therefore not compatible with <a href="https://github.com/HumbleSoftware/js-imagediff">imagediff</a> .</span>

    <h2>Why Succss over <a href="https://github.com/cburgmer/csscritic">CSS Critic</a> ?</h2>
    <span class="headline">It seems that there is a lot of CSS Regression testing tools getting released these days !</span>
    <span class="headline">I don't know much about CSS Critic, I read about it lately on the imagediff users list.</span>
    <span class="headline">Among other limitations listed on the CSS Critic's github page, I can tell that it uses a mandatory "RegressionRunner.html" file runnable with firefox only.</span>

    <h2>Succss is complete, with a smooth learning curve.</h2>
    <span class="headline">Succss is a complete CSS regression testing tool having
    its own command line utility rather than something else ("casperjs test", "gulp"),
    it's easy to learn, easy to install and fast to use. If you're into CSS regression testing,
give it a try !</span>
    </article>

    <article id="customize">

     <h1>Custom validations</h1>
      
    </article>    

    <article id="fork">

      <h1>Fork Succss !</h1>
      <iframe src="http://ghbtns.com/github-btn.html?user=mdo&repo=github-buttons&type=fork&size=large"
  allowtransparency="false" frameborder="0" scrolling="0" width="95" height="30"></iframe>
      <iframe src="http://ghbtns.com/github-btn.html?user=mdo&repo=github-buttons&type=watch&size=large"
  allowtransparency="false" frameborder="0" scrolling="0" width="95" height="30"></iframe>

    </article>

      <div id="more-infos">
        <span class="headline" id="more-infos-headline">Do you want more infos ?</span>
        <div id="more-infos-links">
          <a href="/usecases">.) Typical use cases</a>
          <a href="/installation">.) Installation Troubleshooting</a>
          <a href="/configuration">.) Advanced Configuration</a>
          <a href="/commandline">.) Master Succss Commandline</a>
          <a href="/customize">.) Custom Validations</a>
          <a href="/why">.) Why another CSS regression testing tool ?</a>
          <a href="/fork">.) Succss at its source !</a>
          <a href="/index.html">--- Back home</a>
        </div>
      </div>

  </div>

  <aside id="colors"></aside>

</body>
</html>